# Implementation of MXMNet+MCM

## Requirements
CUDA : 10.2
Python : 3.8

The other dependencies can be installed with:
```
pip install -r requirements.txt
```
## How to run

It is required to produce one extend file `extend_qm9.pt` that contained node featured learned by Motif Convolution Layer (MCL).
Such file could be generated by running `extend_pyg.py` in `graph_match` folder. 

```
python main.py --target 0 --n_layer 6 --extend-file "extend_qm9.pt"   --batch_size 128 --cutoff 5.0  --lr 1e-3
```
Optional arguments:
```
  --extend-file     Path for the file with node features learned by MCL.
  --gpu             GPU number
  --seed            random seed (default: 920)
  --epochs          number of epochs to train
  --lr              initial learning rate
  --wd              weight decay value
  --n_layer         number of hidden layers
  --dim             size of input hidden units
  --batch_size      batch size
  --target          index of target (0~11 except 4)  for prediction on QM9
  --cutoff          distance cutoff used in the global layer
```
## Node embeddings learned by MCM. 
The reproduction code for t-SNE visualization in Figure 4 is provided in [tsne visual folder](https://drive.google.com/drive/folders/1R-DQEIQBbQKlrLJNlVsdYR93uQ-I7_fY?usp=sharing) (shared google drive), where we stored the node embeddings learned by MCM as well as the manually labeled carbons. 

![TSNE_visual](https://github.com/yifeiwang15/MotifConv/blob/main/MCM_for_qm9/MCM_tsne_visual.png)

## Acknowledgment
Part of code is modified from [MXMNet](https://arxiv.org/abs/2011.07457). 
Thanks to Shuo Zhang for giving instructions on reproducing their work.

